{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\oghen\\\\OneDrive\\\\Documents\\\\ClikBate\\\\Clikbate\\\\src\\\\upload\\\\VideoEditor.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useState } from \"react\";\nimport { Grid } from \"@material-ui/core\";\nimport { useSelector } from \"react-redux\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction VideoEditorx({\n  VideoUrl,\n  VideoUrl2,\n  ShowVideo2,\n  ShowVideo,\n  setShowVideo2,\n  setShowVideo\n}) {\n  _s();\n\n  ///\n  const videoPlayerRef = useRef(null); ///\n  ///DARKMODE FROM REDUX\n\n  const {\n    darkmode\n  } = useSelector(state => ({ ...state.GlobalReducer\n  }));\n  const darkmodeReducer = darkmode; // New state for recorded video URL\n\n  const [recordedVideoUrl, setRecordedVideoUrl] = useState(null);\n  const [rec, setRec] = useState(false); // Function to start recording\n\n  const startRecording = (sourceVideoUrl, startTime, duration) => {\n    const video = videoPlayerRef.current;\n\n    if (video) {\n      video.src = sourceVideoUrl;\n      video.currentTime = startTime;\n\n      video.onloadedmetadata = () => {\n        video.currentTime = startTime;\n      };\n\n      video.onseeked = () => {\n        video.play();\n        const stream = video.captureStream(); // Specify MIME type and quality parameters\n\n        const options = {\n          mimeType: 'video/webm; codecs=vp9',\n          // or 'video/mp4' based on browser support\n          videoBitsPerSecond: 800 // Adjust bitrate as needed\n\n        };\n        let recorder;\n\n        if (MediaRecorder.isTypeSupported(options.mimeType)) {\n          recorder = new MediaRecorder(stream, options);\n        } else {\n          recorder = new MediaRecorder(stream); // Fallback to default settings\n        }\n\n        const chunks = [];\n\n        recorder.ondataavailable = e => chunks.push(e.data);\n\n        recorder.onstop = () => {\n          const blob = new Blob(chunks, {\n            type: options.mimeType\n          });\n          const url = URL.createObjectURL(blob);\n          setRecordedVideoUrl(url);\n          video.pause();\n          setTimeout(() => {\n            setRec(true);\n          }, 3000);\n        };\n\n        recorder.start();\n        setTimeout(() => {\n          recorder.stop();\n        }, duration * 1000);\n      };\n\n      video.load();\n    }\n  }; // Call this function when you want to start recording\n  // For example: startRecording(VideoUrl, 0, 10) for a 10-second clip from the start\n\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Grid, {\n      xs: 12,\n      style: {\n        display: ShowVideo || ShowVideo2 ? 'block' : 'none',\n        position: 'fixed',\n        top: '0vh',\n        height: '100vh',\n        backgroundColor: '#555555',\n        width: '100%',\n        margin: 'auto',\n        textAlign: 'center'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          startRecording(VideoUrl, 400, 17);\n        },\n        style: {\n          padding: '2vh',\n          position: 'fixed',\n          top: '3vh',\n          zIndex: 20\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }, this), ShowVideo && /*#__PURE__*/_jsxDEV(\"video\", {\n        src: VideoUrl,\n        controls: true,\n        style: {\n          width: '40%',\n          margin: 'auto'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 23\n      }, this), ShowVideo2 && /*#__PURE__*/_jsxDEV(\"video\", {\n        src: VideoUrl2,\n        controls: true,\n        style: {\n          width: '40%',\n          margin: 'auto'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 24\n      }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n        ref: videoPlayerRef,\n        src: VideoUrl,\n        controls: true,\n        style: {\n          width: '40%',\n          margin: 'auto'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 9\n      }, this), recordedVideoUrl && rec ? /*#__PURE__*/_jsxDEV(\"video\", {\n        src: recordedVideoUrl,\n        controls: true,\n        style: {\n          width: '40%',\n          margin: 'auto'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 36\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n}\n\n_s(VideoEditorx, \"dQfVpWJmR0wEehZFt3HWYz1ZSkE=\", false, function () {\n  return [useSelector];\n});\n\n_c = VideoEditorx;\nexport const VideoEditor = /*#__PURE__*/React.memo(VideoEditorx);\n_c2 = VideoEditor;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"VideoEditorx\");\n$RefreshReg$(_c2, \"VideoEditor\");","map":{"version":3,"sources":["C:/Users/oghen/OneDrive/Documents/ClikBate/Clikbate/src/upload/VideoEditor.tsx"],"names":["React","useRef","useState","Grid","useSelector","VideoEditorx","VideoUrl","VideoUrl2","ShowVideo2","ShowVideo","setShowVideo2","setShowVideo","videoPlayerRef","darkmode","state","GlobalReducer","darkmodeReducer","recordedVideoUrl","setRecordedVideoUrl","rec","setRec","startRecording","sourceVideoUrl","startTime","duration","video","current","src","currentTime","onloadedmetadata","onseeked","play","stream","captureStream","options","mimeType","videoBitsPerSecond","recorder","MediaRecorder","isTypeSupported","chunks","ondataavailable","e","push","data","onstop","blob","Blob","type","url","URL","createObjectURL","pause","setTimeout","start","stop","load","display","position","top","height","backgroundColor","width","margin","textAlign","padding","zIndex","VideoEditor","memo"],"mappings":"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","sourcesContent":["import React, {\r\n  useRef,\r\n  useState,\r\n  useEffect,\r\n  useLayoutEffect,\r\n  useCallback,\r\n} from \"react\";\r\n\r\nimport { Grid } from \"@material-ui/core\";\r\nimport MoreHorizIcon from \"@material-ui/icons/MoreHoriz\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { useSpring, animated } from \"react-spring\";\r\nimport Masonry from \"@mui/lab/Masonry\";\r\nimport CircleIcon from \"@mui/icons-material/Circle\";\r\nimport Cropper from \"react-easy-crop\";\r\nimport MusicNoteIcon from \"@mui/icons-material/MusicNote\";\r\nimport PhotoIcon from \"@mui/icons-material/Photo\";\r\nimport CloseIcon from \"@mui/icons-material/Close\";\r\nimport GifIcon from \"@mui/icons-material/Gif\";\r\nimport ChevronRightIcon from \"@mui/icons-material/ChevronRight\";\r\nimport Slider from \"@mui/material/Slider\";\r\nimport { AnySoaRecord } from \"dns\";\r\nimport { PreviewCanvas } from \"./PreviewCanvas\";\r\nimport { PreviewCanvasCropAll } from \"./PreviewCanvasCropAll\";\r\nimport CropIcon from \"@mui/icons-material/Crop\";\r\nimport CheckIcon from \"@mui/icons-material/Check\";\r\nimport { matchPc, matchTablet, matchMobile } from \"../DetectDevice\";\r\n\r\ninterface HTMLVideoElementWithCapture extends HTMLVideoElement {\r\n  captureStream(): MediaStream;\r\n}\r\n\r\n\r\n\r\nfunction VideoEditorx({ VideoUrl, VideoUrl2, ShowVideo2, ShowVideo, setShowVideo2, setShowVideo }: any): JSX.Element {\r\n\r\n  ///\r\n\r\n  const videoPlayerRef = useRef<HTMLVideoElementWithCapture>(null);\r\n\r\n\r\n\r\n  ///\r\n  ///DARKMODE FROM REDUX\r\n  interface RootStateGlobalReducer {\r\n    GlobalReducer: {\r\n      darkmode: boolean;\r\n    };\r\n  }\r\n  const { darkmode } = useSelector((state: RootStateGlobalReducer) => ({\r\n    ...state.GlobalReducer,\r\n  }));\r\n\r\n  const darkmodeReducer = darkmode;\r\n\r\n\r\n\r\n  // New state for recorded video URL\r\n  const [recordedVideoUrl, setRecordedVideoUrl] = useState(null);\r\n\r\n  const [rec, setRec] = useState(false);\r\n\r\n  // Function to start recording\r\n  const startRecording = (sourceVideoUrl: any, startTime: any, duration: any) => {\r\n    const video = videoPlayerRef.current;\r\n\r\n    if (video) {\r\n      video.src = sourceVideoUrl;\r\n      video.currentTime = startTime;\r\n\r\n      video.onloadedmetadata = () => {\r\n        video.currentTime = startTime;\r\n      };\r\n\r\n      video.onseeked = () => {\r\n        video.play();\r\n        const stream = video.captureStream();\r\n\r\n        // Specify MIME type and quality parameters\r\n        const options = {\r\n          mimeType: 'video/webm; codecs=vp9', // or 'video/mp4' based on browser support\r\n          videoBitsPerSecond: 800 // Adjust bitrate as needed\r\n        };\r\n\r\n        let recorder: any;\r\n        if (MediaRecorder.isTypeSupported(options.mimeType)) {\r\n          recorder = new MediaRecorder(stream, options);\r\n        } else {\r\n          recorder = new MediaRecorder(stream); // Fallback to default settings\r\n        }\r\n\r\n        const chunks: any = [];\r\n        recorder.ondataavailable = (e: any) => chunks.push(e.data);\r\n        recorder.onstop = () => {\r\n          const blob = new Blob(chunks, { type: options.mimeType });\r\n          const url: any = URL.createObjectURL(blob);\r\n          setRecordedVideoUrl(url);\r\n          video.pause();\r\n          setTimeout(() => {\r\n            setRec(true);\r\n          }, 3000);\r\n        };\r\n\r\n        recorder.start();\r\n        setTimeout(() => {\r\n          recorder.stop();\r\n        }, duration * 1000);\r\n      };\r\n\r\n      video.load();\r\n    }\r\n  };\r\n\r\n\r\n  // Call this function when you want to start recording\r\n  // For example: startRecording(VideoUrl, 0, 10) for a 10-second clip from the start\r\n\r\n  return (\r\n    <>\r\n\r\n      <Grid xs={12} style={{ display: ShowVideo || ShowVideo2 ? 'block' : 'none', position: 'fixed', top: '0vh', height: '100vh', backgroundColor: '#555555', width: '100%', margin: 'auto', textAlign: 'center' }} >\r\n        {/* ... other components */}\r\n\r\n        <button onClick={() => {\r\n          startRecording(VideoUrl, 400, 17);\r\n        }} style={{ padding: '2vh', position: 'fixed', top: '3vh', zIndex: 20 }}></button>\r\n        {ShowVideo && <video src={VideoUrl} controls style={{ width: '40%', margin: 'auto' }}></video>}\r\n        {ShowVideo2 && <video src={VideoUrl2} controls style={{ width: '40%', margin: 'auto' }}></video>}\r\n\r\n        <video ref={videoPlayerRef} src={VideoUrl} controls style={{ width: '40%', margin: 'auto' }}></video>\r\n\r\n\r\n\r\n        {/* Preview for recorded video */}\r\n        {recordedVideoUrl && rec ? <video src={recordedVideoUrl} controls style={{ width: '40%', margin: 'auto' }}></video> : null}\r\n      </Grid >\r\n    </>\r\n  );\r\n}\r\n\r\nexport const VideoEditor = React.memo(VideoEditorx)"]},"metadata":{},"sourceType":"module"}